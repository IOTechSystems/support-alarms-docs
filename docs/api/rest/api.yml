openapi: 3.0.0
info:
  title: Alarm Management API
  description: API for managing alarms, states, and state groups in EdgeX
  version: 3.0.0
  contact:
    name: iotechsys
    email: support@iotechsys.com

servers:
  - url: /api/v3

tags:
  - name: alarms
    description: Alarm management operations
  - name: states
    description: State management operations
  - name: stategroups
    description: State group operations
  - name: routes
    description: Alarm routing operations
  - name: actions
    description: Alarm action operations
  - name: conditions
    description: Alarm condition operations

paths:
  /alarms:
    get:
      tags:
        - alarms
      summary: List alarms
      description: Retrieve a list of all alarms in the system with filtering capabilities
      parameters:
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Field to sort results by
        - name: severity
          in: query
          schema:
            type: string
            enum: [CRITICAL, MAJOR, MINOR, WARNING, INFO]
          description: Filter by severity level
        - name: enabled
          in: query
          schema:
            type: boolean
          description: Filter by enabled status
        - name: latched
          in: query
          schema:
            type: boolean
          description: Filter by latched status
        - name: suppressed
          in: query
          schema:
            type: boolean
          description: Filter by suppressed status
        - name: shelved
          in: query
          schema:
            type: boolean
          description: Filter by shelved status
        - name: outOfService
          in: query
          schema:
            type: boolean
          description: Filter by out of service status
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlarmsResponse'

  /alarms/id/{id}:
    get:
      tags:
        - alarms
      summary: Get alarm by ID
      description: Retrieve a specific alarm by its unique identifier
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Alarm'
        '404':
          $ref: '#/components/responses/NotFound'

  /alarms/id/{id}/disable:
    put:
      tags:
        - alarms
      summary: Disable alarm
      description: Disable a specific alarm by ID. Disabling an alarm prevents it from evaluating its condition and generating new states.
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/enable:
    put:
      tags:
        - alarms
      summary: Enable alarm
      description: Enable a previously disabled alarm, allowing it to resume normal operation.
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/suppress:
    put:
      tags:
        - alarms
      summary: Suppress alarm
      description: Suppress an alarm. Suppression prevents an alarm from being reported even when its condition becomes true.
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/unsuppress:
    put:
      tags:
        - alarms
      summary: Unsuppress alarm
      description: Unsuppress a specific alarm by ID
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/shelve:
    put:
      tags:
        - alarms
      summary: Shelve alarm
      description: Shelve an alarm. Shelving is an operator-initiated action to temporarily prevent an alarm from being displayed.
      parameters:
        - $ref: '#/components/parameters/alarmId'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                shelvingTime:
                  type: number
                  format: float
                  description: Optional duration in milliseconds for timed shelving
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/unshelve:
    put:
      tags:
        - alarms
      summary: Unshelve alarm
      description: Unshelve a specific alarm by ID
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/reset:
    put:
      tags:
        - alarms
      summary: Reset latched alarm
      description: Reset a latched alarm. The alarm must be inactive, acknowledged, and confirmed (if required) before reset will succeed.
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/service-remove:
    put:
      tags:
        - alarms
      summary: Remove from service
      description: Mark an alarm as out of service, typically during maintenance periods
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /alarms/id/{id}/service-place:
    put:
      tags:
        - alarms
      summary: Place in service
      description: Return an alarm to service after maintenance
      parameters:
        - $ref: '#/components/parameters/alarmId'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /states:
    get:
      tags:
        - states
      summary: List states
      description: Retrieve a list of all states with filtering capabilities
      parameters:
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Field to sort results by
        - name: alarmId
          in: query
          schema:
            type: string
          description: Filter by associated alarm ID
        - name: severity
          in: query
          schema:
            type: string
            enum: [CRITICAL, MAJOR, MINOR, WARNING, INFO]
          description: Filter by severity level
        - name: retain
          in: query
          schema:
            type: boolean
          description: Filter by retain status
        - name: enabled
          in: query
          schema:
            type: boolean
          description: Filter by enabled status
        - name: acked
          in: query
          schema:
            type: boolean
          description: Filter by acknowledged status
        - name: confirmed
          in: query
          schema:
            type: boolean
          description: Filter by confirmed status
        - name: active
          in: query
          schema:
            type: boolean
          description: Filter by active status
        - name: suppressed
          in: query
          schema:
            type: boolean
          description: Filter by suppressed status
        - name: shelved
          in: query
          schema:
            type: boolean
          description: Filter by shelved status
        - name: outOfService
          in: query
          schema:
            type: boolean
          description: Filter by out of service status
        - name: latched
          in: query
          schema:
            type: boolean
          description: Filter by latched status
        - name: timestampStart
          in: query
          schema:
            type: int
          description: Filter by timestamp range start (unix timestamp)
        - name: timestampEnd
          in: query
          schema:
            type: int
          description: Filter by timestamp range end (unix timestamp)
        - name: routed
          in: query
          schema:
            type: string
            enum: [NONE, SUCCESS, PARTIAL_SUCCESS, FAILURE]
          description: Filter by routing status
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatesResponse'

  /states/id/{id}/acknowledge:
    put:
      tags:
        - states
      summary: Acknowledge state
      description: Acknowledge that an operator is aware of the alarm condition
      parameters:
        - $ref: '#/components/parameters/stateId'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentInput'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /states/id/{id}/confirm:
    put:
      tags:
        - states
      summary: Confirm state
      description: Confirm that appropriate action has been taken to address the alarm condition
      parameters:
        - $ref: '#/components/parameters/stateId'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentInput'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/InvalidStateTransition'

  /routes:
    get:
      tags:
        - routes
      summary: List routes
      description: Retrieve a list of all alarm routes
      parameters:
        - name: id
          in: query
          schema:
            type: string
          description: Filter by route ID
        - name: name
          in: query
          schema:
            type: string
          description: Filter by route name
        - name: conditionId
          in: query
          schema:
            type: string
          description: Filter by condition ID
        - name: actionId
          in: query
          schema:
            type: string
          description: Filter by action ID
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Sort field and direction (e.g., desc(name), asc(name))
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoutesResponse'

    post:
      tags:
        - routes
      summary: Create route
      description: Create a new alarm route
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RouteCreateRequest'
      responses:
        '201':
          description: Route created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RouteResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /routes/id/{id}:
    patch:
      tags:
        - routes
      summary: Update route
      description: Update an existing alarm route
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string

          description: Route ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RouteUpdateRequest'
      responses:
        '200':
          description: Route updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RouteResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '400':
          $ref: '#/components/responses/BadRequest'

    delete:
      tags:
        - routes
      summary: Delete route
      description: Delete an alarm route
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string

          description: Route ID
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'

  /routes/routeId/{routeId}/actions/actionId/{actionId}:
    post:
      tags:
        - routes
      summary: Associate action with route
      description: Associate an action with a route
      parameters:
        - name: routeId
          in: path
          required: true
          schema:
            type: string
          description: Route ID
        - name: actionId
          in: path
          required: true
          schema:
            type: string

          description: Action ID
      responses:
        '200':
          description: Action associated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RouteResponse'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags:
        - routes
      summary: Dissociate action from route
      description: Remove an action's association with a route
      parameters:
        - name: routeId
          in: path
          required: true
          schema:
            type: string
          description: Route ID
        - name: actionId
          in: path
          required: true
          schema:
            type: string
          description: Action ID
      responses:
        '200':
          description: Action dissociated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RouteResponse'
        '404':
          $ref: '#/components/responses/NotFound'

  /actions:
    get:
      tags:
        - actions
      summary: List actions
      description: Retrieve a list of all alarm actions
      parameters:
        - name: id
          in: query
          schema:
            type: string
          description: Filter by action ID
        - name: name
          in: query
          schema:
            type: string
          description: Filter by action name
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Sort field and direction (e.g., desc(name), asc(name))
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionsResponse'

    post:
      tags:
        - actions
      summary: Create action
      description: Create a new alarm action
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActionCreateRequest'
      responses:
        '201':
          description: Action created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /actions/id/{id}:
    patch:
      tags:
        - actions
      summary: Update action
      description: Update an existing alarm action
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Action ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActionUpdateRequest'
      responses:
        '200':
          description: Action updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActionResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '400':
          $ref: '#/components/responses/BadRequest'

    delete:
      tags:
        - actions
      summary: Delete action
      description: Delete an alarm action
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: Action ID
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'

  /conditions:
    get:
      tags:
        - conditions
      summary: List conditions
      description: Retrieve a list of all alarm conditions
      parameters:
        - name: id
          in: query
          schema:
            type: string
          description: Filter by condition ID
        - name: name
          in: query
          schema:
            type: string
          description: Filter by condition name
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Sort field and direction (e.g., desc(name), asc(name))
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConditionsResponse'

    post:
      tags:
        - conditions
      summary: Create condition
      description: Create a new alarm condition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConditionCreateRequest'
      responses:
        '201':
          description: Condition created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConditionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /conditions/id/{id}:
    patch:
      tags:
        - conditions
      summary: Update condition
      description: Update an existing alarm condition
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string

          description: Condition ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConditionUpdateRequest'
      responses:
        '200':
          description: Condition updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConditionResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '400':
          $ref: '#/components/responses/BadRequest'
    delete:
      tags:
        - conditions
      summary: Delete condition
      description: Delete an alarm condition
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string

          description: Condition ID
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '404':
          $ref: '#/components/responses/NotFound'

  /test-alarm:
    post:
      tags:
        - misc
      summary: Trigger test alarm
      description: Trigger a test alarm with specified severity
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - severity
              properties:
                severity:
                  type: string
                  enum: [CRITICAL, HIGH, MEDIUM, LOW]
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '400':
          $ref: '#/components/responses/BadRequest'
    delete:
      tags:
        - misc
      summary: Reset test alarm
      description: Reset the test alarm
      responses:
        '200':
          $ref: '#/components/responses/Success'

  /route-failed-alarm:
    delete:
      tags:
        - misc
      summary: Reset route failed alarm
      description: Reset the route failed alarm for a specific action type
      parameters:
        - name: actionType
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/ActionType'
      responses:
        '200':
          $ref: '#/components/responses/Success'
        '400':
          $ref: '#/components/responses/BadRequest'

  /stategroups:
    get:
      tags:
        - stategroups
      summary: List state groups
      description: Retrieve a list of all state groups
      parameters:
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of items to skip
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Number of items to return
        - name: sortBy
          in: query
          schema:
            type: string
          description: Field to sort results by
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StateGroupsResponse'

components:
  parameters:
    alarmId:
      in: path
      name: id
      required: true
      schema:
        type: string
        format: uuid
      description: Unique identifier of the alarm
    
    stateId:
      in: path
      name: id
      required: true
      schema:
        type: string
        format: uuid
      description: Unique identifier of the state

  responses:
    Success:
      description: Operation completed successfully
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BaseResponse'

    BadRequest:
      description: Invalid request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    Unauthorized:
      description: Unauthorized access
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    InvalidStateTransition:
      description: Invalid state transition
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

  schemas:
    BaseResponse:
      type: object
      properties:
        apiVersion:
          type: string
          example: "v3"
        statusCode:
          type: integer
        message:
          type: string
    ErrorResponse:
      type: object
      properties:
        apiVersion:
          type: string
          example: "v3"
        message:
          type: string
        details:
          type: array
          items:
            type: object
            properties:
              code:
                type: string
              message:
                type: string

    AlarmsResponse:
      type: object
      properties:
        alarms:
          type: array
          items:
            $ref: '#/components/schemas/Alarm'
        status:
          $ref: '#/components/schemas/BaseResponse'
        metadata:
          type: object
          properties:
            totalCount:
              type: integer

    StatesResponse:
      type: object
      properties:
        states:
          type: array
          items:
            $ref: '#/components/schemas/State'
        status:
          $ref: '#/components/schemas/BaseResponse'
        metadata:
          type: object
          properties:
            totalCount:
              type: integer

    StateGroupsResponse:
      type: object
      properties:
        stateGroups:
          type: array
          items:
            $ref: '#/components/schemas/StateGroup'
        status:
          $ref: '#/components/schemas/BaseResponse'
        metadata:
          type: object
          properties:
            totalCount:
              type: integer

    State:
      type: object
      description: Represents the state of an alarm
      properties:
        id:
          type: string
        alarmId:
          type: string
        severity:
          type: string
          enum: [CRITICAL, MAJOR, MINOR, WARNING, INFO]
        comment:
          type: string
          description: Optional comment associated with this state
        retain:
          type: boolean
          description: Indicates if the state requires attention
        enabled:
          type: boolean
          description: Indicates if the alarm is enabled
        acked:
          type: boolean
          description: Indicates if the alarm has been acknowledged
        confirmed:
          type: boolean
          description: Indicates if corrective action has been taken
        active:
          type: boolean
          description: Indicates if the alarm condition is currently active
        suppressed:
          type: boolean
          description: Indicates if the alarm is suppressed
        shelved:
          type: boolean
          description: Indicates if the alarm is shelved
        outOfService:
          type: boolean
          description: Indicates if the alarm is in maintenance
        latched:
          type: boolean
          description: Indicates if the alarm requires additional processing
        timestamp:
          type: string
          format: date-time
          description: Time the state occurred
        routed:
          type: string
          enum: [NONE, SUCCESS, PARTIAL_SUCCESS, FAILURE]
          description: Alarm routing status
        userId:
          type: string
          description: ID of the user who caused the state change
        status:
          type: integer
          description: Status code of the alarm state

    Alarm:
      type: object
      description: Represents an alarm configuration
      properties:
        id:
          type: string
        currentStateGroupId:
          type: string
        device:
          $ref: '#/components/schemas/Device'
        currentState:
          $ref: '#/components/schemas/State'
        alarmLimit:
          oneOf:
            - $ref: '#/components/schemas/LevelAlarmLimit'
            - $ref: '#/components/schemas/DeviationAlarmLimit'
            - $ref: '#/components/schemas/RateOfChangeAlarmLimit'
            - $ref: '#/components/schemas/OffNormalAlarmLimit'
        description:
          type: string
        group:
          type: string
        applicationType:
          type: string

    StateGroup:
      type: object
      description: Represents a lifecycle of states from active to inactive
      properties:
        id:
          type: string
        alarmId:
          type: string
        stateIds:
          type: array
          items:
            type: string
        initialState:
          $ref: '#/components/schemas/State'
        currentState:
          $ref: '#/components/schemas/State'
        complete:
          type: boolean
          description: Whether this group is historical
        duration:
          type: number
          format: float
          description: Duration from active to inactive state
        triggeredValue:
          type: object
          description: Current process value that triggered the alarm

    Device:
      type: object
      properties:
        deviceName:
          type: string
        resourceName:
          type: string

    BaseAlarmLimit:
      type: object
      properties:
        type:
          type: string
          enum: [LEVEL, DEVIATION, RATE_OF_CHANGE, OFF_NORMAL]
        hysteresis:
          type: number
          format: float
        deadband:
          type: number
          format: float

    LevelAlarmLimit:
      allOf:
        - $ref: '#/components/schemas/BaseAlarmLimit'
        - type: object
          properties:
            highHighLimit:
              type: number
              format: float
            highLimit:
              type: number
              format: float
            lowLimit:
              type: number
              format: float
            lowLowLimit:
              type: number
              format: float

    DeviationAlarmLimit:
      allOf:
        - $ref: '#/components/schemas/BaseAlarmLimit'
        - type: object
          properties:
            setpoint:
              type: number
              format: float
            highDeviation:
              type: number
              format: float
            lowDeviation:
              type: number
              format: float

    RateOfChangeAlarmLimit:
      allOf:
        - $ref: '#/components/schemas/BaseAlarmLimit'
        - type: object
          properties:
            positiveROCLimit:
              type: number
              format: float
            negativeROCLimit:
              type: number
              format: float
            timeInterval:
              type: number
              format: float

    OffNormalAlarmLimit:
      allOf:
        - $ref: '#/components/schemas/BaseAlarmLimit'
        - type: object
          properties:
            normalState:
              type: string
            allowedStates:
              type: array
              items:
                type: string

    CommentInput:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          minLength: 1
          maxLength: 1000

    Route:
      type: object
      properties:
        id:
          type: string
          description: The route ID
        name:
          type: string
          description: The route name
        description:
          type: string
          description: Optional description
        condition:
          $ref: '#/components/schemas/Condition'
        delay:
          type: integer
          description: Delay time (in minutes) to wait before an alarm is routed
        retries:
          type: integer
          description: The number of retries to run the action before terminated
        schedule:
          type: string
          description: Schedule string (in iCalender format) for route enablement window
        actions:
          type: array
          items:
            $ref: '#/components/schemas/Action'
        enableStatus:
          type: boolean
          description: Route enabled status
        tsCreated:
          type: string
          description: Unix timestamp
        tsModified:
          type: string
          description: Unix timestamp

    RouteCreateRequest:
      type: object
      required:
        - name
        - conditionId
        - schedule
        - enableStatus
      properties:
        name:
          type: string
        description:
          type: string
        conditionId:
          type: string
        delay:
          type: integer
        retries:
          type: integer
        schedule:
          type: string
        enableStatus:
          type: boolean

    RouteUpdateRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        conditionId:
          type: string
        delay:
          type: integer
        retries:
          type: integer
        schedule:
          type: string
        enableStatus:
          type: boolean

    Action:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        type:
          $ref: '#/components/schemas/ActionType'
        config:
          type: object
        enableStatus:
          type: boolean
        stopConditionType:
          $ref: '#/components/schemas/ActionStopConditionType'
        duration:
          type: integer
        tsCreated:
          type: string
        tsModified:
          type: string

    ActionType:
      type: string
      enum:
        - EMAIL
        - ALSENSE
        - MQTT
        - RELAY
        - VARIABLE
        - TELEGRAM

    ActionStopConditionType:
      type: string
      enum:
        - NONE
        - ONTIME
        - ONACKED
        - ONCLEARED

    ActionCreateRequest:
      type: object
      required:
        - name
        - type
        - enableStatus
      properties:
        name:
          type: string
        description:
          type: string
        type:
          $ref: '#/components/schemas/ActionType'
        config:
          type: object
        enableStatus:
          type: boolean
        stopConditionType:
          $ref: '#/components/schemas/ActionStopConditionType'
        duration:
          type: integer

    ActionUpdateRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        type:
          $ref: '#/components/schemas/ActionType'
        config:
          type: object
        enableStatus:
          type: boolean
        stopConditionType:
          $ref: '#/components/schemas/ActionStopConditionType'
        duration:
          type: integer

    Condition:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        deviceNames:
          type: array
          items:
            type: string
        deviceGroups:
          type: array
          items:
            type: string
        severities:
          type: array
          items:
            $ref: '#/components/schemas/SeverityType'
        tsCreated:
          type: string
        tsModified:
          type: string

    SeverityType:
      type: string
      enum:
        - CRITICAL
        - HIGH
        - MEDIUM
        - LOW

    ConditionCreateRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        deviceNames:
          type: array
          items:
            type: string
        deviceGroups:
          type: array
          items:
            type: string
        severities:
          type: array
          items:
            $ref: '#/components/schemas/SeverityType'

    ConditionUpdateRequest:
      type: object
      properties:
        name:
          type: string
        deviceNames:
          type: array
          items:
            type: string
        deviceGroups:
          type: array
          items:
            type: string
        severities:
          type: array
          items:
            $ref: '#/components/schemas/SeverityType'

    ConditionResponse:
      type: object
      properties:
        condition:
          $ref: '#/components/schemas/Condition'
        status:
          $ref: '#/components/schemas/Status'

    ActionResponse:
      type: object
      properties:
        action:
          $ref: '#/components/schemas/Action'
        status:
          $ref: '#/components/schemas/Status'

    RouteResponse:
      type: object
      properties:
        route:
          $ref: '#/components/schemas/Route'
        status:
          $ref: '#/components/schemas/Status'

    ConditionsResponse:
      type: object
      properties:
        conditions:
          type: array
          items:
            $ref: '#/components/schemas/Condition'
        status:
          $ref: '#/components/schemas/Status'
        metadata:
          $ref: '#/components/schemas/Metadata'

    ActionsResponse:
      type: object
      properties:
        actions:
          type: array
          items:
            $ref: '#/components/schemas/Action'
        status:
          $ref: '#/components/schemas/Status'
        metadata:
          $ref: '#/components/schemas/Metadata'

    RoutesResponse:
      type: object
      properties:
        routes:
          type: array
          items:
            $ref: '#/components/schemas/Route'
        status:
          $ref: '#/components/schemas/Status'
        metadata:
          $ref: '#/components/schemas/Metadata'

    Metadata:
      type: object
      properties:
        count:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
        total:
          type: integer

    Status:
      type: object
      properties:
        error:
          type: string



